name: Sync to HF Spaces (Official Action)
on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      # 1. 拉取 GitHub 代码
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # 2. 官方 HF 同步 Action（一键同步，无需手动 Git 操作）
      - name: Push to HF Spaces
        uses: huggingface/hub-action@main
        with:
          # 你的 HF Spaces 仓库 ID（用户名/空间名）
          repo_id: "iyougame/newdemo"
          # 仓库类型：spaces
          repo_type: "space"
          # 推送所有文件（可指定路径，如: path: app.py,requirements.txt）
          path: "."
          # HF Token（从 GitHub 密钥读取）
          token: ${{ secrets.HF_TOKEN }}
          # 强制推送覆盖
          commit_message: "Sync from GitHub: ${{ github.sha }}"
          force: true
